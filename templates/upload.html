{% extends "layout.html" %}

{% block header %}
{% endblock %}

{% block nav %}
{% endblock %}

{% block section %}
    
    <div id="upload_apk" class="jumbotron", style="max-width: 300px; margin: 0 auto; padding-left: 60px; padding-right: 60px">
        <h2>Upload APK</h2>
        <div id="upload">
            <form @submit.prevent="submit" class="form-horizontal">
                <fieldset>
                    <div class="field">
                        <input type="file" name='file' multiple size="50" style="margin: 0 auto; " >
                    </div>
                    <button type="submit" class="btn btn-success" style="margin: 0 auto; ">upload</button>
                </fieldset>
            </form>
        </div>
    </div>
    
{% endblock %}

{% block footer %}
{% endblock %}

{% block template %}
{% endblock %}

{% block script %}
    <script>
        new Vue({
            el: '#upload',
            data: {
                apiUrl: '/upload',
                redirectURL: '/modification'
            },
            methods: {
                submit: function(event) {
                    // FormData支援把 Form 元素丟進去
                    var formData = new FormData(event.target)

                    this.$http.post(this.apiUrl, formData)
                        .then(function (response) {
                            window.location.href = this.redirectURL;
                    }, function (err) {
                        alert('Upload Error')
                        console.log(err)
                    })

                }
            }

        })
    </script>
{% endblock %}